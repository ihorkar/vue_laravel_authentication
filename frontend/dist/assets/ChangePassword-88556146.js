import{f as o,z as x,o as r,c as d,b as C,a as e,d as g,h as f,v as _,E as h,F as b,G as M,g as P,H as U,D as E}from"./index-1e3561dc.js";import{_ as V}from"./TheDashboardPageHeader-caa9a6a8.js";import{o as B,a as N,d as D,g as $,c as q}from"./authenticator-e0e20fc2.js";import{n as k}from"./notificator-4d76e68d.js";const S={class:"grid"},T={for:"newpassword"},z={for:"confirmnewpassword"},I={key:0,id:"passwordsDoesntMatchAlert"},A=["aria-invalid"],F=e("small",null,"Password must be 8-20 characters, with a mix of uppercase and lowercase letters, numbers, and symbols.",-1),K={key:0,style:{color:"#43a047"}},L={id:"formErrorList"},G={key:0},H=["aria-busy","disabled"],Y={id:"UpdatePasswordModal"},j=e("h3",null,"Confirm your action",-1),J={for:"currentpassword"},O=e("small",null,"In order to proceed, please provide your current password:",-1),Q=["disabled"],se={__name:"ChangePassword",setup(R){const t=o(""),n=o(""),u=o(""),w=o(null),v=o([]),i=o(null),p=o(!1),m=o(!1);function c(l){l=="open"?B(document.getElementById("UpdatePasswordModal")):N(document.getElementById("UpdatePasswordModal"))}function y(){p.value=!0,D.post("https://evbkzynoncxd.neptune.trulywired.link/api/changepassword",{password:u.value,new_password:t.value},{headers:{Authorization:"Bearer "+$()},timeout:3e4}).then(l=>{m.value=!0,k("Your password was updated successfully","success")}).catch(l=>{typeof l.response.data<"u"&&(v.value=l.response.data.errors),w.value=!0,k("Password update failed","warning"),l.response.status==401&&q(!0)}).finally(()=>{t.value="",n.value="",u.value="",p.value=!1})}return x([t,n],()=>{(t.value!==""||n.value!=="")&&(w.value=null,m.value=!1),n.value!==""&&t.value!==n.value?i.value=!0:i.value=null}),(l,s)=>(r(),d(b,null,[C(V,{title:"Change password",content:"Please fill the required fields below."}),e("form",{onSubmit:s[2]||(s[2]=P(a=>c("open"),["prevent"]))},[e("div",S,[e("label",T,[g(" New password: "),f(e("input",{type:"password",id:"newpassword",name:"newpassword",maxlength:"20",placeholder:"New","onUpdate:modelValue":s[0]||(s[0]=a=>t.value=a),required:""},null,512),[[_,t.value]])]),e("label",z,[g(" Confirm password: "),i.value?(r(),d("span",I,"Passwords doesn't match")):h("",!0),f(e("input",{type:"password",id:"confirmnewpassword",name:"confirmnewpassword",maxlength:"20",placeholder:"Confirm","onUpdate:modelValue":s[1]||(s[1]=a=>n.value=a),"aria-invalid":i.value,required:""},null,8,A),[[_,n.value]])])]),F,m.value?(r(),d("span",K,"Update success!")):h("",!0),e("ul",L,[w.value&&v.value.length>0?(r(),d("div",G,[(r(!0),d(b,null,M(v.value,a=>(r(),d("li",{key:a},E(a),1))),128))])):h("",!0)]),e("button",{type:"submit","aria-busy":p.value,disabled:p.value||i.value},"Save password",8,H)],32),e("dialog",Y,[e("article",null,[j,e("label",J,[O,f(e("input",{type:"password",id:"currentpassword",name:"currentpassword",maxlength:"20","onUpdate:modelValue":s[3]||(s[3]=a=>u.value=a),placeholder:"Current password",onKeyup:s[4]||(s[4]=U(a=>(c("close"),y()),["enter"])),required:"",autofocus:""},null,544),[[_,u.value]])]),e("footer",null,[e("button",{role:"button",onClick:s[5]||(s[5]=a=>c("close")),class:"secondary"},"Cancel"),e("button",{role:"button",disabled:!u.value,onClick:s[6]||(s[6]=a=>(c("close"),y()))},"Confirm",8,Q)])])])],64))}};export{se as default};
