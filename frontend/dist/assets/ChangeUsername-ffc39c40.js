import{f as o,z as k,o as l,c as u,b as x,a as e,d as C,u as _,D as y,h,v as b,E as g,F as w,G as M,g as E,H as B}from"./index-1e3561dc.js";import{_ as D}from"./TheDashboardPageHeader-caa9a6a8.js";import{o as V,a as I,d as $,g as N,u as v,c as S}from"./authenticator-e0e20fc2.js";import{n as U}from"./notificator-4d76e68d.js";const T={for:"username"},q=["aria-busy"],z=["aria-invalid"],L=e("small",null,"Must be between 10 and 25 characters, only letters and numbers.",-1),F={key:0,style:{color:"#43a047"}},K={id:"formErrorList"},Y={key:0},A=["aria-busy","disabled"],G={id:"updateUsernameModal"},H=e("h3",null,"Confirm your action",-1),P={for:"currentpassword"},j=e("small",null,"In order to proceed, please provide your current password:",-1),J=["disabled"],Z={__name:"ChangeUsername",setup(O){const n=o(""),r=o(""),d=o(null),p=o([]),i=o(!1),m=o(!1);function c(t){t=="open"?V(document.getElementById("updateUsernameModal")):I(document.getElementById("updateUsernameModal"))}function f(){i.value=!0,$.post("https://evbkzynoncxd.neptune.trulywired.link/api/changeusername",{password:r.value,new_username:n.value},{headers:{Authorization:"Bearer "+N()},timeout:3e4}).then(t=>{n.value="",v.updateUserData(),U("Your username was updated successfully","success"),m.value=!0}).catch(t=>{typeof t.response.data<"u"&&(p.value=t.response.data.errors),d.value=!0,U("Username update failed","warning"),t.response.status==401&&S(!0)}).finally(()=>{r.value="",i.value=!1})}return k(n,()=>{d.value=null,n.value!==""&&(m.value=!1)}),(t,s)=>(l(),u(w,null,[x(D,{title:"Change username",content:"Please fill the required fields below."}),e("form",{onSubmit:s[1]||(s[1]=E(a=>c("open"),["prevent"]))},[e("label",T,[C(" Your current username is: "),e("code",{"aria-busy":_(v).userDataIsLoading},y(_(v).email),9,q),h(e("input",{type:"text",id:"username",name:"username",maxlength:"25",placeholder:"Insert new username","onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),"aria-invalid":d.value,required:""},null,8,z),[[b,n.value]]),L,m.value?(l(),u("span",F,"Update success!")):g("",!0)]),e("ul",K,[d.value&&p.value.length>0?(l(),u("div",Y,[(l(!0),u(w,null,M(p.value,a=>(l(),u("li",{key:a},y(a),1))),128))])):g("",!0)]),e("button",{type:"submit","aria-busy":i.value,disabled:i.value},"Save username",8,A)],32),e("dialog",G,[e("article",null,[H,e("label",P,[j,h(e("input",{type:"password",id:"currentpassword",name:"currentpassword","onUpdate:modelValue":s[2]||(s[2]=a=>r.value=a),placeholder:"Current password",onKeyup:s[3]||(s[3]=B(a=>(c("close"),f()),["enter"])),required:"",autofocus:""},null,544),[[b,r.value]])]),e("footer",null,[e("button",{onClick:s[4]||(s[4]=a=>c("close")),role:"button",class:"secondary"},"Cancel"),e("button",{disabled:!r.value,onClick:s[5]||(s[5]=a=>(c("close"),f())),role:"button"},"Confirm",8,J)])])])],64))}};export{Z as default};
