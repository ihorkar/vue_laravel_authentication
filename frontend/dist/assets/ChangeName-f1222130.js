import{f as o,j as U,o as r,c as u,a as x,b as e,d as M,u as f,t as y,h as _,v as h,k as b,F as g,l as N,g as C,I as D}from"./index-7b447cf0.js";import{_ as B}from"./DashboardPageHeader-94c7f206.js";import{u as E,o as I,c as V,a as $,g as S,f as T,n as w,e as q,d as k}from"./authenticator-6ad4618e.js";const L={for:"name"},z=["aria-busy"],F=["aria-invalid"],K=e("small",null,"Must be between 10 and 25 characters, only letters and numbers.",-1),Y={key:0,style:{color:"#43a047"}},j={id:"formErrorList"},A={key:0},P=["aria-busy","disabled"],G={id:"UpdateNameModal"},H=e("h3",null,"Confirm your action",-1),J={for:"currentpassword"},O=e("small",null,"In order to proceed, please provide your current password:",-1),Q=["disabled"],ee={__name:"ChangeName",setup(R){E();const n=o(""),l=o(""),d=o(null),i=o([]),p=o(!1),m=o(!1);function c(s){s=="open"?I(document.getElementById("UpdateNameModal")):V(document.getElementById("UpdateNameModal"))}function v(){p.value=!0,$.post("https://evbkzynoncxd.general.trulywired.link/api/changename",{password:l.value,new_name:n.value},{headers:{Authorization:"Bearer "+S()},timeout:3e4}).then(s=>{n.value="",T(),w("Your display name was updated successfully","success"),m.value=!0}).catch(s=>{typeof s.response.data<"u"&&(i.value=s.response.data.errors),d.value=!0,w("Display name update failed","warning"),s.response.status==401&&q(!0)}).finally(()=>{l.value="",p.value=!1})}return U(n,()=>{d.value=null,n.value!==""&&(m.value=!1)}),(s,a)=>(r(),u(g,null,[x(B,{title:"Change display name",content:"Please fill the required fields below."}),e("form",{onSubmit:a[1]||(a[1]=C(t=>c("open"),["prevent"]))},[e("label",L,[M(" Your current display name is: "),e("code",{"aria-busy":f(k).userDataIsLoading},y(f(k).name),9,z),_(e("input",{type:"text",id:"name",name:"name",maxlength:"25",placeholder:"Insert new name","onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),"aria-invalid":d.value,required:""},null,8,F),[[h,n.value]]),K,m.value?(r(),u("span",Y,"Update success!")):b("",!0)]),e("ul",j,[d.value&&typeof i.value<"u"&&i.value.length>0?(r(),u("div",A,[(r(!0),u(g,null,N(i.value,t=>(r(),u("li",{key:t},y(t),1))),128))])):b("",!0)]),e("button",{type:"submit","aria-busy":p.value,disabled:p.value},"Save display name",8,P)],32),e("dialog",G,[e("article",null,[H,e("label",J,[O,_(e("input",{type:"password",id:"currentpassword",name:"currentpassword","onUpdate:modelValue":a[2]||(a[2]=t=>l.value=t),placeholder:"Current password",onKeyup:a[3]||(a[3]=D(t=>(c("close"),v()),["enter"])),required:"",autofocus:""},null,544),[[h,l.value]])]),e("footer",null,[e("button",{onClick:a[4]||(a[4]=t=>c("close")),role:"button",class:"secondary"},"Cancel"),e("button",{disabled:!l.value,onClick:a[5]||(a[5]=t=>(c("close"),v())),role:"button"},"Confirm",8,Q)])])])],64))}};export{ee as default};
