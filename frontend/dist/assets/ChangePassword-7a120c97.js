import{f as o,j as x,o as r,c as d,a as C,b as e,d as g,h as f,v as _,k as h,F as b,l as M,g as P,I as U,t as V}from"./index-623f2cc7.js";import{_ as B}from"./DashboardPageHeader-e1daffce.js";import{o as E,c as N,a as $,g as q,n as k,e as D}from"./authenticator-788da403.js";const I={class:"grid"},S={for:"newpassword"},T={for:"confirmnewpassword"},z={key:0,id:"passwordsDoesntMatchAlert"},A=["aria-invalid"],F=e("small",null,"Password must be 8-20 characters, with a mix of uppercase and lowercase letters, numbers, and symbols.",-1),K={key:0,style:{color:"#43a047"}},L={id:"formErrorList"},j={key:0},Y=["aria-busy","disabled"],G={id:"UpdatePasswordModal"},H=e("h3",null,"Confirm your action",-1),J={for:"currentpassword"},O=e("small",null,"In order to proceed, please provide your current password:",-1),Q=["disabled"],ee={__name:"ChangePassword",setup(R){const t=o(""),l=o(""),u=o(""),w=o(null),v=o([]),i=o(null),p=o(!1),m=o(!1);function c(n){n=="open"?E(document.getElementById("UpdatePasswordModal")):N(document.getElementById("UpdatePasswordModal"))}function y(){p.value=!0,$.post("https://evbkzynoncxd.general.trulywired.link/api/changepassword",{password:u.value,new_password:t.value},{headers:{Authorization:"Bearer "+q()},timeout:3e4}).then(n=>{m.value=!0,k("Your password was updated successfully","success")}).catch(n=>{typeof n.response.data<"u"&&(v.value=n.response.data.errors),w.value=!0,k("Password update failed","warning"),n.response.status==401&&D(!0)}).finally(()=>{t.value="",l.value="",u.value="",p.value=!1})}return x([t,l],()=>{(t.value!==""||l.value!=="")&&(w.value=null,m.value=!1),l.value!==""&&t.value!==l.value?i.value=!0:i.value=null}),(n,s)=>(r(),d(b,null,[C(B,{title:"Change password",content:"Please fill the required fields below."}),e("form",{onSubmit:s[2]||(s[2]=P(a=>c("open"),["prevent"]))},[e("div",I,[e("label",S,[g(" New password: "),f(e("input",{type:"password",id:"newpassword",name:"newpassword",maxlength:"20",placeholder:"New","onUpdate:modelValue":s[0]||(s[0]=a=>t.value=a),required:""},null,512),[[_,t.value]])]),e("label",T,[g(" Confirm password: "),i.value?(r(),d("span",z,"Passwords doesn't match")):h("",!0),f(e("input",{type:"password",id:"confirmnewpassword",name:"confirmnewpassword",maxlength:"20",placeholder:"Confirm","onUpdate:modelValue":s[1]||(s[1]=a=>l.value=a),"aria-invalid":i.value,required:""},null,8,A),[[_,l.value]])])]),F,m.value?(r(),d("span",K,"Update success!")):h("",!0),e("ul",L,[w.value&&v.value.length>0?(r(),d("div",j,[(r(!0),d(b,null,M(v.value,a=>(r(),d("li",{key:a},V(a),1))),128))])):h("",!0)]),e("button",{type:"submit","aria-busy":p.value,disabled:p.value||i.value},"Save password",8,Y)],32),e("dialog",G,[e("article",null,[H,e("label",J,[O,f(e("input",{type:"password",id:"currentpassword",name:"currentpassword",maxlength:"20","onUpdate:modelValue":s[3]||(s[3]=a=>u.value=a),placeholder:"Current password",onKeyup:s[4]||(s[4]=U(a=>(c("close"),y()),["enter"])),required:"",autofocus:""},null,544),[[_,u.value]])]),e("footer",null,[e("button",{role:"button",onClick:s[5]||(s[5]=a=>c("close")),class:"secondary"},"Cancel"),e("button",{role:"button",disabled:!u.value,onClick:s[6]||(s[6]=a=>(c("close"),y()))},"Confirm",8,Q)])])])],64))}};export{ee as default};
