import{f as m,r as v,o as y,c as g,a as r,b as e,w as f,d as i,h as _,v as b,I as h,F as w}from"./index-623f2cc7.js";import{_ as k}from"./DashboardPageHeader-e1daffce.js";import{o as C,c as x,a as B,g as M,b as T,n as u,e as A}from"./authenticator-788da403.js";const D={class:"grid"},E=e("i",{class:"fa-regular fa-pen-to-square"},null,-1),I=e("i",{class:"fa-regular fa-pen-to-square"},null,-1),V=["aria-busy"],$=e("i",{class:"fa-regular fa-trash-can"},null,-1),N={id:"deactivateModal"},q=e("h3",null,"Confirm your action",-1),S=e("p",{style:{"margin-bottom":"30px"}},"Please be aware that this action cannot be undone. After deactivation, all data associated with your account will be deleted. Also, you won't be able to use your email from this account again. ",-1),z={for:"currentpassword"},F=e("small",null,"In order to proceed, please provide your current password:",-1),K=["disabled"],W={__name:"Settings",setup(L){const n=m(""),l=m(!1);function s(o){o=="open"?C(document.getElementById("deactivateModal")):x(document.getElementById("deactivateModal"))}function d(){l.value=!0,B.post("https://evbkzynoncxd.general.trulywired.link/api/deactivate",{password:n.value},{headers:{Authorization:"Bearer "+M()},timeout:3e4}).then(o=>{T(),u("Your account was sucessfully deactivated","default","10000")}).catch(o=>{o.response.status==401?u("The password is incorrect","warning","5000"):u("Account deactivation attempt has failed","danger","5000"),o.response.status==401&&A(!0)}).finally(()=>{n.value="",l.value=!1})}function c(o){o.target.setAttribute("aria-busy","true"),o.target.innerHTML=""}return(o,t)=>{const p=v("router-link");return y(),g(w,null,[r(k,{title:"Settings",content:"What would you like to change?"}),e("div",D,[r(p,{to:{name:"Change Name"},style:{"text-decoration":"none",color:"inherit"}},{default:f(()=>[e("button",{class:"menuButton secondary outline",onClick:t[0]||(t[0]=a=>c(a))},[E,i(" Change my display name")])]),_:1}),r(p,{to:{name:"Change Password"},style:{"text-decoration":"none",color:"inherit"}},{default:f(()=>[e("button",{class:"menuButton secondary outline",onClick:t[1]||(t[1]=a=>c(a))},[I,i(" Change my password")])]),_:1}),e("button",{onClick:t[2]||(t[2]=a=>s("open")),class:"menuButton outline",style:{color:"#d81b60 !important","border-color":"#d81b60 !important"},"aria-busy":l.value},[$,i(" Deactivate my account")],8,V)]),e("dialog",N,[e("article",null,[q,S,e("label",z,[F,_(e("input",{type:"password",id:"currentpassword",name:"currentpassword","onUpdate:modelValue":t[3]||(t[3]=a=>n.value=a),placeholder:"Current password",onKeyup:t[4]||(t[4]=h(a=>(s("close"),d()),["enter"])),required:"",autofocus:""},null,544),[[b,n.value]])]),e("footer",null,[e("button",{onClick:t[5]||(t[5]=a=>s("close")),role:"button",class:"secondary"},"Cancel"),e("button",{id:"deactivateButton",disabled:!n.value,onClick:t[6]||(t[6]=a=>(s("close"),d())),role:"button"}," DEACTIVATE ",8,K)])])])],64)}}};export{W as default};
