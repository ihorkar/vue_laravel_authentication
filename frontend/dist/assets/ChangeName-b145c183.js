import{f as o,j as U,o as r,c as u,b as x,a as e,d as M,u as v,t as y,h as _,v as h,k as b,F as g,l as N,g as C,G as D}from"./index-1f9bd4da.js";import{_ as B}from"./TheDashboardPageHeader-499b8bff.js";import{u as E,o as V,c as I,a as $,g as S,f as T,e as q,d as w}from"./authenticator-d7b5f7d8.js";import{n as k}from"./notificator-4d76e68d.js";const L={for:"name"},z=["aria-busy"],F=["aria-invalid"],K=e("small",null,"Must be between 10 and 25 characters, only letters and numbers.",-1),Y={key:0,style:{color:"#43a047"}},j={id:"formErrorList"},A={key:0},G=["aria-busy","disabled"],P={id:"UpdateNameModal"},H=e("h3",null,"Confirm your action",-1),J={for:"currentpassword"},O=e("small",null,"In order to proceed, please provide your current password:",-1),Q=["disabled"],ae={__name:"ChangeName",setup(R){E();const n=o(""),l=o(""),d=o(null),i=o([]),p=o(!1),m=o(!1);function c(s){s=="open"?V(document.getElementById("UpdateNameModal")):I(document.getElementById("UpdateNameModal"))}function f(){p.value=!0,$.post("https://evbkzynoncxd.general.trulywired.link/api/changename",{password:l.value,new_name:n.value},{headers:{Authorization:"Bearer "+S()},timeout:3e4}).then(s=>{n.value="",T(),k("Your display name was updated successfully","success"),m.value=!0}).catch(s=>{typeof s.response.data<"u"&&(i.value=s.response.data.errors),d.value=!0,k("Display name update failed","warning"),s.response.status==401&&q(!0)}).finally(()=>{l.value="",p.value=!1})}return U(n,()=>{d.value=null,n.value!==""&&(m.value=!1)}),(s,a)=>(r(),u(g,null,[x(B,{title:"Change display name",content:"Please fill the required fields below."}),e("form",{onSubmit:a[1]||(a[1]=C(t=>c("open"),["prevent"]))},[e("label",L,[M(" Your current display name is: "),e("code",{"aria-busy":v(w).userDataIsLoading},y(v(w).name),9,z),_(e("input",{type:"text",id:"name",name:"name",maxlength:"25",placeholder:"Insert new name","onUpdate:modelValue":a[0]||(a[0]=t=>n.value=t),"aria-invalid":d.value,required:""},null,8,F),[[h,n.value]]),K,m.value?(r(),u("span",Y,"Update success!")):b("",!0)]),e("ul",j,[d.value&&typeof i.value<"u"&&i.value.length>0?(r(),u("div",A,[(r(!0),u(g,null,N(i.value,t=>(r(),u("li",{key:t},y(t),1))),128))])):b("",!0)]),e("button",{type:"submit","aria-busy":p.value,disabled:p.value},"Save display name",8,G)],32),e("dialog",P,[e("article",null,[H,e("label",J,[O,_(e("input",{type:"password",id:"currentpassword",name:"currentpassword","onUpdate:modelValue":a[2]||(a[2]=t=>l.value=t),placeholder:"Current password",onKeyup:a[3]||(a[3]=D(t=>(c("close"),f()),["enter"])),required:"",autofocus:""},null,544),[[h,l.value]])]),e("footer",null,[e("button",{onClick:a[4]||(a[4]=t=>c("close")),role:"button",class:"secondary"},"Cancel"),e("button",{disabled:!l.value,onClick:a[5]||(a[5]=t=>(c("close"),f())),role:"button"},"Confirm",8,Q)])])])],64))}};export{ae as default};
